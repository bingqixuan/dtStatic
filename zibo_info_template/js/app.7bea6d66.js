(function(e){function t(t){for(var i,r,s=t[0],l=t[1],c=t[2],d=0,p=[];d<s.length;d++)r=s[d],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&p.push(a[r][0]),a[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);h&&h(t);while(p.length)p.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],i=!0,s=1;s<n.length;s++){var l=n[s];0!==a[l]&&(i=!1)}i&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var i={},a={app:0},o=[];function r(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var h=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"08c3":function(e,t,n){"use strict";n("6386")},"56d7":function(e,t,n){"use strict";n.r(t);n("25ba"),n("5f1c"),n("6ba0"),n("b47f");var i=n("1f37"),a=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[e.url?e._e():t("Menu",{attrs:{msg:"Menu"},on:{getUrl:e.getUrl}}),e.url?t("Main",{attrs:{msg:"Main",url:e.url},on:{getUrl:e.getUrl}}):e._e()],1)},o=[],r=function(){var e=this,t=e._self._c;return t("div",[t("div",{attrs:{id:"container"}}),t("div",{attrs:{id:"tooltip"}}),t("el-button-group",{staticClass:"button-group"},[t("el-button",{attrs:{type:"",icon:""},on:{click:e.groupOneChange}},[e._v("首页总览")]),t("el-button",{attrs:{type:"",icon:""},on:{click:e.groupTwoChange}},[e._v("应急管理")]),t("el-button",{attrs:{type:"",icon:""},on:{click:e.groupThreeChange}},[e._v("能源管理")]),t("el-button",{attrs:{type:"",icon:""},on:{click:e.groupFourChange}},[e._v("环境监测")]),t("el-button",{attrs:{type:"",icon:""},on:{click:e.groupFiveChange}},[e._v("综合能源监控中心")])],1)],1)},s=[],l=(n("eec3"),n("9f60"),n("94f0"),n("0c84"),n("2843"),n("4057"),n("3f5b"),n("e5b4"),n("00f2"),n("15a6"),n("a450"),n("131f"),n("566e"),n("0ec2")),c=(n("1bc7"),n("246f"),n("b303")),h=n("1023"),d=n("3904"),p=n("b4e2");function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=m(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){s=!0,o=e},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}function m(e,t){if(e){if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var f={data:function(){return{camera:null,scene:null,renderer:null,labelRenderer:null,container:null,controller:null,map:null,raycaster:null,mouse:null,tooltip:null,lastPick:null,mapEdgeLightObj:{mapEdgePoints:[],lightOpacityGeometry:null,lightSpeed:3,lightCurrentPos:0,lightOpacitys:null},groupOne:new c["u"],groupTwo:new c["u"],groupThree:new c["u"],groupFour:new c["u"],cityWaveMeshArr:[],cityCylinderMeshArr:[],cityMarkerMeshArr:[],cityNumMeshArr:[],alarmWaveMeshArr:[],alarmCylinderMeshArr:[],alarmNameMeshArr:[],energyWaveMeshArr:[],energyCylinderMeshArr:[],energyNameMeshArr:[],monitorWaveMeshArr:[],monitorIconMeshArr:[],monitorNameMeshArr:[],mapConfig:{deep:.2},cameraPosArr:[{x:0,y:-3,z:3.8}],dataTotal:[{name:"淄川区",adcode:"370302",total:129,brief:"经营范围包括凭资质证从事炉窑工程专业承包贰级；工业窑炉热工设备、环保节能设备、机电设备、仪器仪表、电器的制造、销售及调试。"},{name:"张店区",adcode:"370303",total:89,brief:"经营范围包括凭资质证从事炉窑工程专业承包贰级；工业窑炉热工设备、环保节能设备、机电设备、仪器仪表、电器的制造、销售及调试。"},{name:"博山区",adcode:"370304",total:205,brief:"经营范围包括凭资质证从事炉窑工程专业承包贰级；工业窑炉热工设备、环保节能设备、机电设备、仪器仪表、电器的制造、销售及调试。"},{name:"沂源县",adcode:"370323",total:26,brief:"经营范围包括凭资质证从事炉窑工程专业承包贰级；工业窑炉热工设备、环保节能设备、机电设备、仪器仪表、电器的制造、销售及调试。"},{name:"高青县",adcode:"370322",total:8,brief:"经营范围包括凭资质证从事炉窑工程专业承包贰级；工业窑炉热工设备、环保节能设备、机电设备、仪器仪表、电器的制造、销售及调试。"}],dataAlarm:[{name:"张店区",adcode:"370303",level:1,type:"压力异常",content:"检测到压力过高，超过标准2000Pa",company:"窑炉5厂",location:"张店区万山村",tel:"18861899887"},{name:"沂源县",adcode:"370303",level:1,type:"温度异常",content:"检测到温度2900­°C，超过标准1200-1800­°C",company:"窑炉1厂",location:"沂源县白塔镇南万山村",tel:"13561899812"},{name:"博山区",adcode:"370303",level:2,type:"压力异常",content:"检测到压力过高，超过标准2000Pa",company:"窑炉2厂",location:"博山区白塔镇南万山村",tel:"14561899817"},{name:"临淄区",adcode:"370303",level:3,type:"用水异常",content:"检测到用水异常，超过标准10万吨",company:"窑炉3厂",location:"临淄区南万山村",tel:"18061899829"}],dataEnergy:[{name:"张店区",adcode:"370303",level:1,type:"用水异常",content:"检测到用水异常",company:"窑炉5厂",location:"张店区万山村",tel:"18861899887"},{name:"高青县",adcode:"370303",level:1,type:"用电异常",content:"检测到用电异常",company:"窑炉1厂",location:"沂源县白塔镇南万山村",tel:"13561899812"},{name:"淄川区",adcode:"370303",level:2,type:"用气异常",content:"检测到用气异常",company:"窑炉2厂",location:"博山区白塔镇南万山村",tel:"14561899817"}],dataMonitor:[{name:"临淄区",adcode:"370303",monitor:"监控点一",content:"正常",company:"窑炉5厂",location:"张店区万山村"},{name:"张店区",adcode:"370303",monitor:"监控点二",content:"正常",company:"窑炉1厂",location:"沂源县白塔镇南万山村"},{name:"淄川区",adcode:"370303",monitor:"监控点三",content:"正常",company:"窑炉2厂",location:"博山区白塔镇南万山村"}]}},props:["url"],mounted:function(){this.init(),this.animate(),window.addEventListener("resize",this.onWindowSize)},methods:{init:function(){this.container=document.getElementById("container"),this.setScene(),this.setCamera(),this.setRenderer(),this.setController(),this.addHelper(),this.loadMapData(),this.setEarth(),this.setRaycaster(),this.setLight()},setScene:function(){this.scene=new c["N"]},setCamera:function(){this.camera=new c["F"](75,window.innerWidth/window.innerHeight,.1,500),this.camera.position.set(0,-5,1),this.camera.lookAt(new c["Y"](0,0,0))},setRenderer:function(){this.renderer=new c["Z"]({antialias:!0}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.container.appendChild(this.renderer.domElement),this.labelRenderer=new p["b"],this.labelRenderer.setSize(this.container.clientWidth,this.container.clientHeight),this.labelRenderer.domElement.style.position="absolute",this.labelRenderer.domElement.style.top=0,this.container.appendChild(this.labelRenderer.domElement)},setController:function(){this.controller=new d["a"](this.camera,this.labelRenderer.domElement),this.controller.minDistance=2,this.controller.maxDistance=5.5,this.controller.minAzimuthAngle=-Math.PI/4,this.controller.maxAzimuthAngle=Math.PI/4,this.controller.minPolarAngle=1,this.controller.maxPolarAngle=Math.PI-.1},addHelper:function(){new c["d"](150),new c["t"](100,30,2894892,8947848)},setLight:function(){var e=new c["c"](4210752,1.2);this.scene.add(e);var t=new c["m"](16777215,1);this.scene.add(t);var n=new c["I"]("#ffffff",1.8,20);n.position.set(1,-7,7),this.scene.add(n);var i=new c["J"](n);this.scene.add(i);var a=new c["I"]("#4161ff",1.4,20);a.position.set(0,7,3),this.scene.add(a);new c["J"](a)},loadMapData:function(){var e=this,t=new c["r"];t.load("/static/map/json/zibo.json",(function(t){var n=JSON.parse(t);e.addMapGeometry(n)}))},addMapGeometry:function(e){var t=this;this.map=new c["E"];var n=h["a"]().center([118.2,36.7]).translate([.2,.15]);e.features.forEach((function(e){var i=new c["E"],a=e.geometry.coordinates;a.forEach((function(a){a.forEach((function(a){for(var o=new c["P"],r=new c["w"]({color:"#ffffff"}),s=new c["h"],h=new Array,d=0;d<a.length;d++){var p=n(a[d]),u=Object(l["a"])(p,2),m=u[0],g=u[1];0===d&&o.moveTo(m,-g),o.lineTo(m,-g),h.push(new c["Y"](m,-g,t.mapConfig.deep)),t.mapEdgeLightObj.mapEdgePoints.push([m,-g,t.mapConfig.deep])}s.setFromPoints(h);var f={depth:t.mapConfig.deep,bevelEnabled:!1},v=new c["q"](o,f),y=new c["D"]({color:"#4161ff",transparent:!0,opacity:.4,side:c["s"]}),w=new c["C"]({color:"#10004a",transparent:!0,opacity:.7,side:c["s"]}),b=new c["A"](v,[y,w]),C=new c["v"](s,r);if(i.properties=e.properties,e.properties.centroid){var M=n(e.properties.centroid),A=Object(l["a"])(M,2),E=A[0],x=A[1];i.properties._centroid=[E,x]}i.add(b),i.add(C)}))})),t.map.add(i)})),this.setMapEdgeLight(),this.setMapName(),this.scene.add(this.map),this.getResponseData()},setMapEdgeLight:function(){var e=new Float32Array(this.mapEdgeLightObj.mapEdgePoints.flat(1));this.mapEdgeLightObj.lightOpacityGeometry=new c["h"],this.mapEdgeLightObj.lightOpacityGeometry.setAttribute("position",new c["g"](e,3)),this.mapEdgeLightObj.lightOpacitys=new Float32Array(e.length).map((function(){return 0})),this.mapEdgeLightObj.lightOpacityGeometry.setAttribute("aOpacity",new c["g"](this.mapEdgeLightObj.lightOpacitys,1));var t="\n          attribute float aOpacity;\n          uniform float uSize;\n          varying float vOpacity;\n\n          void main(){\n              gl_Position = projectionMatrix*modelViewMatrix*vec4(position,1.0);\n              gl_PointSize = uSize;\n\n              vOpacity=aOpacity;\n          }\n          ",n="\n          varying float vOpacity;\n          uniform vec3 uColor;\n\n          float invert(float n){\n              return 1.-n;\n          }\n\n          void main(){\n            if(vOpacity <=0.2){\n                discard;\n            }\n            vec2 uv=vec2(gl_PointCoord.x,invert(gl_PointCoord.y));\n            vec2 cUv=2.*uv-1.;\n            vec4 color=vec4(1./length(cUv));\n            color*=vOpacity;\n            color.rgb*=uColor;\n            gl_FragColor=color;\n          }\n          ",i=new c["O"]({vertexShader:t,fragmentShader:n,transparent:!0,uniforms:{uSize:{value:5},uColor:{value:new c["j"]("#ffffff")}}}),a=new c["K"](this.mapEdgeLightObj.lightOpacityGeometry,i);this.scene.add(a)},setEarth:function(){var e=new c["H"](14,14),t=(new c["W"]).load("/static/map/texture/earth.jpg"),n=(new c["W"]).load("/static/map/texture/earth.jpg"),i=new c["D"]({map:t,bumpMap:n,bumpScale:.05,side:c["s"]}),a=new c["A"](e,i);this.scene.add(a)},setMapName:function(){var e=this;this.map.children.forEach((function(t,n){var i=-t.properties._centroid[1],a=t.properties._centroid[0],o=new c["Y"](a,i,e.mapConfig.deep+.01);e.setCityName(o,t.properties.name)}))},getResponseData:function(){var e=this;setTimeout((function(){e.addCityModel(),e.addAlarmModel(),e.addEnergyModel(),e.addMonitorModel(),setTimeout(e.cameraTween,1e3)}),500)},mapElem2Centroid:function(e){var t=-e.properties._centroid[1],n=e.properties._centroid[0],i=new c["Y"](n,t,this.mapConfig.deep+.01);return i},getMaxV:function(e){var t,n=0,i=u(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;n<a.total&&(n=a.total)}}catch(o){i.e(o)}finally{i.f()}return n},getMinV:function(e){var t,n=1e6,i=u(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;n>a.total&&(n=a.total)}}catch(o){i.e(o)}finally{i.f()}return n},normalization:function(e,t,n){var i=(e-t)/(n-t);return i},addCityModel:function(){var e=this,t=this.getMinV(this.dataTotal),n=this.getMaxV(this.dataTotal);this.map.children.forEach((function(i,a){if(e.dataTotal){var o=e.mapElem2Centroid(i);e.dataTotal.forEach((function(a){var r=e.normalization(a.total,t,n);a.name===i.properties.name&&(e.setCityWave(o),e.setCityMarker(o),e.setCityCylinder(o,r),e.setCityNum(o,r,a))})),e.scene.add(e.groupOne)}}))},addAlarmModel:function(){var e=this;this.map.children.forEach((function(t,n){if(e.dataAlarm){var i=e.mapElem2Centroid(t),a=["#ff1800","#FF8A00","#FAE52D"];e.dataAlarm.forEach((function(n){n.name===t.properties.name&&(e.setAlarmWave(i,a[n.level-1]),e.setAlarmCylinder(i,a[n.level-1]),e.setAlarmName(i,a[n.level-1],n))})),e.groupTwo.visible=!1,e.scene.add(e.groupTwo)}}))},addEnergyModel:function(){var e=this;this.map.children.forEach((function(t,n){if(e.dataEnergy){var i=e.mapElem2Centroid(t),a=["#ff1800","#FF8A00","#FAE52D"];e.dataEnergy.forEach((function(n){n.name===t.properties.name&&(e.setEnergyWave(i,a[n.level-1]),e.setEnergyCylinder(i,a[n.level-1]),e.setEnergyName(i,a[n.level-1],n))})),e.groupThree.visible=!1,e.scene.add(e.groupThree)}}))},addMonitorModel:function(){var e=this;this.map.children.forEach((function(t,n){if(e.dataMonitor){var i=e.mapElem2Centroid(t);e.dataMonitor.forEach((function(n){n.name===t.properties.name&&(e.setMonitorWave(i),e.setMonitorIcon(i),e.setMonitorName(i,n))})),e.groupFour.visible=!1,e.scene.add(e.groupFour)}}))},setCityCylinder:function(e,t){var n=t,i=new c["l"](.08,.08,n,20),a=new c["D"]({color:"#ede619",side:c["s"],blending:c["b"],transparent:!0,precision:"mediump",opacity:.9}),o=new c["A"](i,a);o.position.set(e.x,e.y,e.z+n/2),o.rotateX(Math.PI/2),o.scale.set(1,1,1),o._height=n,this.cityCylinderMeshArr.push(o),this.groupOne.add(o)},setCityWave:function(e){var t=new c["G"](1,1),n=new c["W"],i=n.load("/static/map/texture/wave.png"),a=new c["B"]({color:"#ede619",map:i,transparent:!0,opacity:1,side:c["s"],depthWrite:!1,blending:c["b"]}),o=new c["A"](t,a);o.position.set(e.x,e.y,e.z),o.size=0,this.cityWaveMeshArr.push(o),this.groupOne.add(o)},setCityMarker:function(e){var t=new c["G"](.3,.3),n=new c["W"],i=n.load("/static/map/texture/marker.png"),a=new c["B"]({color:"#ffe000",map:i,transparent:!0,opacity:1,side:c["s"],depthWrite:!1,blending:c["b"]});a.blending=c["k"],a.blendSrc=c["T"],a.blendDst=c["o"],a.blendEquation=c["a"];var o=new c["A"](t,a);o.position.set(e.x,e.y,e.z),o.size=0,this.cityMarkerMeshArr.push(o),this.groupOne.add(o)},setCityNum:function(e,t,n){var i=document.createElement("div");i.className="city-num-label",i.textContent=n.total;var a=document.createElement("div");a.className="city-num-label-content",a.innerHTML="本区县共有窑炉企业 "+n.total+" 个。<br/>介绍："+n.brief,i.appendChild(a);var o=new p["a"](i);o.position.set(e.x,e.y,t+.5),o.visible=!0,this.cityNumMeshArr.push(o),this.groupOne.add(o)},setCityName:function(e,t){var n=this.makeTextSprite(t,{fontface:"微软雅黑",fontsize:28,fontColor:{r:255,g:255,b:255,a:1},borderColor:{r:94,g:94,b:94,a:0},backgroundColor:{r:255,g:255,b:0,a:0},borderThickness:2,round:6});n.position.set(e.x+.06,e.y+0,.22),this.scene.add(n)},makeTextSprite:function(e,t){void 0===t&&(t={});var n=t["fontface"],i=t["fontsize"],a=t["fontColor"],o=t["borderThickness"],r=t["borderColor"],s=t["backgroundColor"],l=document.createElement("canvas"),h=l.getContext("2d");h.font="Bold "+i+"px "+n;var d=h.measureText(e),p=d.width;h.fillStyle="rgba("+s.r+","+s.g+","+s.b+","+s.a+")",h.strokeStyle="rgba("+r.r+","+r.g+","+r.b+","+r.a+")",h.lineWidth=o;var u={width:1.4*p+2*o,height:1.4*i+2*o,round:t["round"]};this.roundRect(h,o/2,o/2,u.width,u.height,u.round),h.fillStyle="rgba("+a.r+","+a.g+","+a.b+","+a.a+")",h.textAlign="center",h.textBaseline="middle",h.fillText(e,u.width/2,u.height/2);var m=new c["V"](l);m.needsUpdate=!0;var g=new c["S"]({map:m,useScreenCoordinates:!1,depthTest:!1}),f=new c["R"](g);return f.scale.set(1,.5,1),f},roundRect:function(e,t,n,i,a,o){e.beginPath(),e.moveTo(t+o,n),e.lineTo(t+i-o,n),e.quadraticCurveTo(t+i,n,t+i,n+o),e.lineTo(t+i,n+a-o),e.quadraticCurveTo(t+i,n+a,t+i-o,n+a),e.lineTo(t+o,n+a),e.quadraticCurveTo(t,n+a,t,n+a-o),e.lineTo(t,n+o),e.quadraticCurveTo(t,n,t+o,n),e.closePath(),e.fill(),e.stroke()},setAlarmWave:function(e,t){var n=new c["G"](1,1),i=new c["W"],a=i.load("/static/map/texture/alarm.png"),o=new c["B"]({color:t,map:a,transparent:!0,opacity:1,side:c["s"],depthWrite:!1,blending:c["b"]}),r=new c["A"](n,o);r.position.set(e.x,e.y,e.z),r.scale.set(.4,.4,.4),this.alarmWaveMeshArr.push(r),this.groupTwo.add(r)},setAlarmCylinder:function(e,t){var n=new c["l"](.1,0,.3,3),i=new c["D"]({color:t,side:c["s"],transparent:!0,opacity:.8}),a=new c["A"](n,i);a.position.set(e.x,e.y,e.z+.3),a.rotateX(Math.PI/2),a.scale.set(1,1,1),this.alarmCylinderMeshArr.push(a),this.groupTwo.add(a)},setAlarmName:function(e,t,n){var i=document.createElement("div");i.className="alarm-label";var a=document.createElement("span");a.className="alarm-label-icon",a.textContent="●",a.style.color=t,i.appendChild(a);var o=document.createElement("span");o.className="alarm-label-text",o.textContent=n.type,i.appendChild(o);var r=document.createElement("div");r.className="alarm-label-content",r.innerHTML="告警："+n.content+"<br/>企业："+n.company+"<br/>位置："+n.location+"<br/>电话："+n.tel,i.appendChild(r);var s=new p["a"](i);s.position.set(e.x,e.y,e.z+.65),s.visible=!1,this.alarmNameMeshArr.push(s),this.groupTwo.add(s)},setEnergyWave:function(e,t){var n=new c["G"](1,1),i=new c["W"],a=i.load("/static/map/texture/alarm.png"),o=new c["B"]({color:t,map:a,transparent:!0,opacity:1,side:c["s"],depthWrite:!1,blending:c["b"]}),r=new c["A"](n,o);r.position.set(e.x,e.y,e.z),r.scale.set(.4,.4,.4),this.energyWaveMeshArr.push(r),this.groupThree.add(r)},setEnergyCylinder:function(e,t){var n=new c["l"](.1,0,.3,20),i=new c["D"]({color:t,side:c["s"],transparent:!0,opacity:.8}),a=new c["A"](n,i);a.position.set(e.x,e.y,e.z+.3),a.rotateX(Math.PI/2),a.scale.set(1,1,1),this.energyCylinderMeshArr.push(a),this.groupThree.add(a)},setEnergyName:function(e,t,n){var i=document.createElement("div");i.className="alarm-label";var a=document.createElement("span");a.className="alarm-label-icon",a.textContent="◆",a.style.color=t,i.appendChild(a);var o=document.createElement("span");o.className="alarm-label-text",o.textContent=n.type,i.appendChild(o);var r=document.createElement("div");r.className="alarm-label-content",r.innerHTML="告警："+n.content+"<br/>企业："+n.company+"<br/>位置："+n.location+"<br/>电话："+n.tel,i.appendChild(r);var s=new p["a"](i);s.position.set(e.x,e.y,e.z+.65),s.visible=!1,this.energyNameMeshArr.push(s),this.groupThree.add(s)},setMonitorWave:function(e){var t=new c["G"](1,1),n=new c["W"],i=n.load("/static/map/texture/marker.png"),a=new c["B"]({color:"#B3FFFF",map:i,transparent:!0,opacity:.9,side:c["s"],depthWrite:!1}),o=new c["A"](t,a);o.position.set(e.x,e.y,e.z),o.scale.set(.4,.4,.4),this.monitorWaveMeshArr.push(o),this.groupFour.add(o)},setMonitorIcon:function(e){var t=new c["H"](1,1),n=(new c["W"]).load("/static/map/texture/monitor.png"),i=new c["D"]({map:n,side:c["n"],blending:c["b"],transparent:!0,opacity:.9}),a=new c["A"](t,i);a.position.set(e.x,e.y,e.z+.25),a.rotateX(Math.PI/4),a.scale.set(.3,.3,.3),this.monitorIconMeshArr.push(a),this.groupFour.add(a)},setMonitorName:function(e,t){var n=document.createElement("div");n.className="alarm-label";var i=document.createElement("span");i.className="alarm-label-icon",i.textContent="◉",i.style.color="#ffffff",n.appendChild(i);var a=document.createElement("span");a.className="alarm-label-text",a.textContent=t.monitor,n.appendChild(a);var o=document.createElement("div");o.className="alarm-label-content",o.innerHTML="状态："+t.content+"<br/>位置："+t.location,n.appendChild(o);var r=new p["a"](n);r.position.set(e.x,e.y,e.z+.65),r.visible=!1,this.monitorNameMeshArr.push(r),this.groupFour.add(r)},setRaycaster:function(){var e=this;this.raycaster=new c["M"],this.mouse=new c["X"],this.tooltip=document.getElementById("tooltip");var t=function(t){e.mouse.x=t.clientX/window.innerWidth*2-1,e.mouse.y=-t.clientY/window.innerHeight*2+1,e.tooltip.style.left=t.clientX+2+"px",e.tooltip.style.top=t.clientY+2+"px"},n=function(t){e.lastPick&&"point"in e.lastPick?e.mapClickTween(e.lastPick.point):e.resetCameraTween()};window.addEventListener("mousemove",t,!1),window.addEventListener("click",n,!1)},showTip:function(){if(this.lastPick){var e=this.lastPick.object.parent.properties;this.tooltip.textContent=e.name,this.tooltip.style.visibility="visible"}else this.tooltip.style.visibility="hidden"},onWindowSize:function(){this.camera.aspect=this.container.clientWidth/this.container.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.labelRenderer.setSize(this.container.clientWidth,this.container.clientHeight)},cityCylinderTween:function(){var e=this;this.cityCylinderMeshArr.forEach((function(t){var n={z:t.position.z},i={z:t.position.z+t._height},a=e;e.$tween.use({begin:n,end:i,time:1e3,onUpdate:function(e){t.position.z=e.z},onComplete:function(){a.cityNumMeshArr.forEach((function(e){e.visible=!0}))}})}))},cameraTween:function(e){if(e=e||0,e>this.cameraPosArr.length-1)return!1;this.controller.enabled=!1;var t={x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z},n={x:this.cameraPosArr[e].x,y:this.cameraPosArr[e].y,z:this.cameraPosArr[e].z},i=this;this.$tween.use({begin:t,end:n,time:1500,onUpdate:function(e){i.camera.position.x=e.x,i.camera.position.y=e.y,i.camera.position.z=e.z,i.controller.update()},onComplete:function(){i.controller.enabled=!0,i.cameraTween(e+1)}})},mapClickTween:function(e){this.controller.enabled=!1;var t={x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z},n={x:e.x,y:e.y,z:e.z+2.5},i=this;this.$tween.use({begin:t,end:n,time:500,onUpdate:function(e){i.camera.position.x=e.x,i.camera.position.y=e.y,i.camera.position.z=e.z,i.camera.lookAt(e.x,e.y,e.z),i.controller.update()},onComplete:function(){i.controller.enabled=!0}})},resetCameraTween:function(){this.controller.enabled=!1;var e={x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z},t={x:this.cameraPosArr[this.cameraPosArr.length-1].x,y:this.cameraPosArr[this.cameraPosArr.length-1].y,z:this.cameraPosArr[this.cameraPosArr.length-1].z},n=this;this.$tween.use({begin:e,end:t,time:500,onUpdate:function(e){n.camera.position.x=e.x,n.camera.position.y=e.y,n.camera.position.z=e.z,n.camera.lookAt(0,0,0),n.controller.update()},onComplete:function(){n.controller.enabled=!0}})},animate:function(){requestAnimationFrame(this.animate),this.showTip(),this.animationMouseover(),this.animationCityWave(),this.animationCityMarker(),this.animationCityCylinder(),this.animationCityEdgeLight(),this.animationAlarmWave(),this.animationAlarmCylinder(),this.animationEnergyWave(),this.animationMonitorWave(),this.controller.update(),this.renderer.render(this.scene,this.camera),this.labelRenderer.render(this.scene,this.camera)},animationMouseover:function(){this.raycaster.setFromCamera(this.mouse,this.camera);var e=this.raycaster.intersectObjects(this.scene.children,!0);this.lastPick&&this.lastPick.object.material[0].color.set("#4161ff"),this.lastPick=null,this.lastPick=e.find((function(e){return e.object.material&&2===e.object.material.length})),this.lastPick&&this.lastPick.object.material[0].color.set("#00035d")},animationCityCylinder:function(){this.cityCylinderMeshArr.forEach((function(e){}))},animationCityWave:function(){this.cityWaveMeshArr.forEach((function(e){e.size+=.005;var t=e.size/1;e.scale.set(t,t,t),e.size<=.5?e.material.opacity=1:e.size>.5&&e.size<=1?e.material.opacity=1-2*(e.size-.5):e.size>1&&e.size<2&&(e.size=0)}))},animationCityMarker:function(){this.cityMarkerMeshArr.forEach((function(e){e.rotation.z+=.05}))},animationCityEdgeLight:function(){if(this.mapEdgeLightObj.lightOpacitys&&this.mapEdgeLightObj.mapEdgePoints){this.mapEdgeLightObj.lightCurrentPos>this.mapEdgeLightObj.mapEdgePoints.length&&(this.mapEdgeLightObj.lightCurrentPos=0),this.mapEdgeLightObj.lightCurrentPos+=this.mapEdgeLightObj.lightSpeed;for(var e=0;e<this.mapEdgeLightObj.lightSpeed;e++)this.mapEdgeLightObj.lightOpacitys[(this.mapEdgeLightObj.lightCurrentPos-e)%this.mapEdgeLightObj.mapEdgePoints.length]=0;for(var t=0;t<100;t++)this.mapEdgeLightObj.lightOpacitys[(this.mapEdgeLightObj.lightCurrentPos+t)%this.mapEdgeLightObj.mapEdgePoints.length]=t/50>2?2:t/50;this.mapEdgeLightObj.lightOpacityGeometry&&(this.mapEdgeLightObj.lightOpacityGeometry.attributes.aOpacity.needsUpdate=!0)}},animationAlarmWave:function(){this.alarmWaveMeshArr.forEach((function(e){e.rotation.z-=.01}))},animationAlarmCylinder:function(){this.alarmCylinderMeshArr.forEach((function(e){e.rotation.y+=.03}))},animationEnergyWave:function(){this.energyWaveMeshArr.forEach((function(e){e.rotation.z-=.01}))},animationMonitorWave:function(){this.monitorWaveMeshArr.forEach((function(e){e.rotation.z+=.03}))},groupOneChange:function(){console.log("groupOneChange"),this.cityNumMeshArr.forEach((function(e){e.visible=!0})),this.alarmNameMeshArr.forEach((function(e){e.visible=!1})),this.energyNameMeshArr.forEach((function(e){e.visible=!1})),this.monitorNameMeshArr.forEach((function(e){e.visible=!1})),this.groupOne.visible=!0,this.groupTwo.visible=!1,this.groupThree.visible=!1,this.groupFour.visible=!1},groupTwoChange:function(){this.cityNumMeshArr.forEach((function(e){e.visible=!1})),this.alarmNameMeshArr.forEach((function(e){e.visible=!0})),this.energyNameMeshArr.forEach((function(e){e.visible=!1})),this.monitorNameMeshArr.forEach((function(e){e.visible=!1})),this.groupOne.visible=!1,this.groupTwo.visible=!0,this.groupThree.visible=!1,this.groupFour.visible=!1},groupThreeChange:function(){console.log("groupThreeChange"),this.cityNumMeshArr.forEach((function(e){e.visible=!1})),this.alarmNameMeshArr.forEach((function(e){e.visible=!1})),this.energyNameMeshArr.forEach((function(e){e.visible=!0})),this.monitorNameMeshArr.forEach((function(e){e.visible=!1})),this.groupOne.visible=!1,this.groupTwo.visible=!1,this.groupThree.visible=!0,this.groupFour.visible=!1},groupFourChange:function(){console.log("groupFourChange"),this.cityNumMeshArr.forEach((function(e){e.visible=!1})),this.alarmNameMeshArr.forEach((function(e){e.visible=!1})),this.energyNameMeshArr.forEach((function(e){e.visible=!1})),this.monitorNameMeshArr.forEach((function(e){e.visible=!0})),this.groupOne.visible=!1,this.groupTwo.visible=!1,this.groupThree.visible=!1,this.groupFour.visible=!0},groupFiveChange:function(){this.$emit("getUrl",null)}}},v=f,y=(n("5708"),n("e607")),w=Object(y["a"])(v,r,s,!1,null,null,null),b=w.exports,C=function(){var e=this;e._self._c;return e._m(0)},M=[function(){var e=this,t=e._self._c;return t("div",[t("div",{attrs:{id:"container"}}),t("div",{attrs:{id:"tooltip"}})])}],A=n("70b0"),E={data:function(){return{camera:null,scene:null,renderer:null,labelRenderer:null,container:null,controller:null,map:null,raycaster:null,mouse:null,tooltip:null,lastPick:null,groupOne:new c["u"],groupTwo:new c["u"],waveMesh1:null,waveMesh2:null,waveMesh3:null,waveMesh4:null,clock:new c["i"]}},mounted:function(){this.init(),this.animate(),window.addEventListener("resize",this.onWindowSize)},methods:{init:function(){this.container=document.getElementById("container"),this.setScene(),this.setCamera(),this.setRenderer(),this.setController(),this.addHelper(),this.addSpace(),this.setRaycaster(),this.setLight(),this.addMenu(),this.addWave()},setScene:function(){this.scene=new c["N"]},setCamera:function(){this.camera=new c["F"](75,window.innerWidth/window.innerHeight,.1,500),this.camera.position.set(0,1,2),this.camera.lookAt(new c["Y"](0,0,0))},setRenderer:function(){this.renderer=new c["Z"]({antialias:!0}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.container.appendChild(this.renderer.domElement)},setController:function(){this.controller=new A["a"](this.camera,this.renderer.domElement),this.controller.lookVertical=!1,this.controller.mouseDragOn=!1,this.controller.movementSpeed=0,this.controller.lookSpeed=.01},addHelper:function(){new c["d"](150),new c["t"](100,30,2894892,8947848)},setLight:function(){var e=new c["c"](4210752,4);this.scene.add(e);new c["m"](16777215,1);var t=new c["I"]("#ffffff",10,2);t.position.set(0,0,0),this.scene.add(t);new c["J"](t)},addMenu:function(){var e=this.camera.position,t=new c["A"](new c["H"](1,1),new c["B"]({map:(new c["W"]).load("/static/home/menu/1.png"),side:c["n"],depthTest:!1,blending:c["b"]}));t.position.set(-2,.3,0),t.lookAt(e),t._type="menu",t._router=1;var n=new c["A"](new c["H"](1,1),new c["B"]({map:(new c["W"]).load("/static/home/menu/2.png"),side:c["n"],depthTest:!1,blending:c["b"]}));n.position.set(-1,.4,-.5),n.lookAt(e),n._type="menu",n._router=2;var i=new c["A"](new c["H"](1,1),new c["B"]({map:(new c["W"]).load("/static/home/menu/3.png"),side:c["n"],depthTest:!1,blending:c["b"]}));i.position.set(0,.4,-1),i.lookAt(e),i._type="menu",i._router=3;var a=new c["A"](new c["H"](1,1),new c["B"]({map:(new c["W"]).load("/static/home/menu/4.png"),side:c["n"],depthTest:!1,blending:c["b"]}));a.position.set(1,.4,-.5),a.lookAt(e),a._type="menu",a._router=4;var o=new c["A"](new c["H"](1,1),new c["B"]({map:(new c["W"]).load("/static/home/menu/5.png"),side:c["n"],depthTest:!1,blending:c["b"]}));o.position.set(2,.3,0),o.lookAt(e),o._type="menu",o._router=5,this.groupOne.add(t),this.groupOne.add(n),this.groupOne.add(i),this.groupOne.add(a),this.groupOne.add(o),this.scene.add(this.groupOne)},addWave:function(){var e=new c["A"](new c["H"](1,1),new c["B"]({map:(new c["W"]).load("/static/home/wave/1.png"),side:c["n"],depthTest:!1,blending:c["b"]}));e.position.set(0,-1.3,0),e.rotateX(Math.PI/2),this.waveMesh1=e;var t=new c["A"](new c["H"](1.8,1.8),new c["B"]({map:(new c["W"]).load("/static/home/wave/2.png"),side:c["n"],depthTest:!1,blending:c["b"]}));t.position.set(0,-.8,0),t.rotateX(Math.PI/2),this.waveMesh2=t;var n=new c["A"](new c["H"](2,2),new c["B"]({map:(new c["W"]).load("/static/home/wave/3.png"),side:c["n"],depthTest:!1,blending:c["b"]}));n.position.set(0,-.3,0),n.rotateX(Math.PI/2),this.waveMesh3=n;var i=new c["A"](new c["H"](3.2,3.2),new c["B"]({map:(new c["W"]).load("/static/home/wave/4.png"),side:c["n"],depthTest:!1,blending:c["b"]}));i.position.set(0,-.3,0),i.rotateX(Math.PI/2),this.waveMesh4=i,this.groupTwo.add(e),this.groupTwo.add(t),this.groupTwo.add(n),this.groupTwo.add(i),this.scene.add(this.groupTwo)},addSpace:function(){var e=[(new c["W"]).load("/static/map/texture/space/4.jpg"),(new c["W"]).load("/static/map/texture/space/2.jpg"),(new c["W"]).load("/static/map/texture/space/1.jpg"),(new c["W"]).load("/static/map/texture/space/6.jpg"),(new c["W"]).load("/static/map/texture/space/3.jpg"),(new c["W"]).load("/static/map/texture/space/5.jpg")],t=[new c["B"]({map:e[0],side:c["e"],precision:"highp"}),new c["B"]({map:e[1],side:c["e"],precision:"highp"}),new c["B"]({map:e[2],side:c["e"],precision:"highp"}),new c["B"]({map:e[3],side:c["e"],precision:"highp"}),new c["B"]({map:e[4],side:c["e"],precision:"highp"}),new c["B"]({map:e[5],side:c["e"],precision:"highp"})],n=new c["f"](300,300,300),i=new c["A"](n,t);i.scale.x=-1,this.scene.add(i)},setRaycaster:function(){var e=this;this.raycaster=new c["M"],this.mouse=new c["X"],this.tooltip=document.getElementById("tooltip");var t=function(t){e.mouse.x=t.clientX/window.innerWidth*2-1,e.mouse.y=-t.clientY/window.innerHeight*2+1,e.tooltip.style.left=t.clientX+2+"px",e.tooltip.style.top=t.clientY+2+"px"},n=function(t){e.mouse.x=t.clientX/window.innerWidth*2-1,e.mouse.y=-t.clientY/window.innerHeight*2+1,e.menuClick()};window.addEventListener("mousemove",t,!1),window.addEventListener("click",n,!1)},menuClick:function(){this.lastPick&&this.lastPick.object._router/1<5&&this.$emit("getUrl",this.lastPick.object._router)},onWindowSize:function(){this.camera.aspect=this.container.clientWidth/this.container.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight)},animate:function(){requestAnimationFrame(this.animate),this.animationMouseover(),this.animationWave(),this.controller.update(this.clock.getDelta()),this.renderer.render(this.scene,this.camera)},animationWave:function(){this.waveMesh1.rotation.z-=.01,this.waveMesh2.rotation.z-=.01,this.waveMesh3.rotation.z-=.01,this.waveMesh4.rotation.z+=.005},animationMouseover:function(){this.raycaster.setFromCamera(this.mouse,this.camera);var e=this.raycaster.intersectObjects(this.scene.children,!0);this.lastPick&&(this.lastPick.object.position.y-=.02,this.lastPick.object.scale.set(1,1,1)),this.lastPick=null,this.lastPick=e.find((function(e){return e.object._type&&"menu"===e.object._type})),this.lastPick&&(this.lastPick.object.position.y+=.02,this.lastPick.object.scale.set(1.2,1.2,1.2))},groupOneChange:function(){console.log("groupOneChange")},groupTwoChange:function(){console.log("groupTwoChange")},groupThreeChange:function(){console.log("groupThreeChange")},groupFourChange:function(){onsole.log("groupFourChange")}}},x=E,O=(n("08c3"),Object(y["a"])(x,C,M,!1,null,null,null)),T=O.exports,P={name:"app",components:{Main:b,Menu:T},data:function(){return{url:null}},methods:{getUrl:function(e){this.url=e}}},z=P,W=(n("a415"),Object(y["a"])(z,a,o,!1,null,null,null)),j=W.exports,k=n("47df"),N=n.n(k),S=(n("55ee"),n("faa4")),_={install:function(e){e.prototype.$tween=this,e.prototype.$tweener=S["a"]},pause:function(e){e.pause()},use:function(e){var t=e.begin,n=e.end,i=e.time,a=void 0===i?1500:i,o=e.delay,r=void 0===o?0:o,s=e.easing,l=void 0===s?S["a"].Easing.Linear.None:s,c=e.onStart,h=e.onUpdate,d=e.onComplete,p=requestAnimationFrame((function e(){p=requestAnimationFrame(e),S["a"].update()}));new S["a"].Tween(t).to(n,a).delay(r).easing(l).onStart((function(){c&&c()})).onUpdate((function(e,t){h&&h(e)})).onComplete((function(){d&&d(),cancelAnimationFrame(p)})).start()}};i["default"].use(N.a),i["default"].use(_),i["default"].config.productionTip=!1,new i["default"]({render:function(e){return e(j)}}).$mount("#app")},5708:function(e,t,n){"use strict";n("8053")},6386:function(e,t,n){},8053:function(e,t,n){},"8dc2":function(e,t,n){},a415:function(e,t,n){"use strict";n("8dc2")}});
//# sourceMappingURL=app.7bea6d66.js.map